function tableUser(){var e=document.getElementById("lableUser"),t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200==this.status&&(e.innerHTML=this.response)},t.open("post","./members/tableUser.php",!0),t.send()}function tableMember(e=0){var t=document.getElementById("monthly").value,n=document.getElementById("yearly").value,s=document.getElementById("lablemembers"),a=document.getElementById("BuildingID").options[document.getElementById("BuildingID").selectedIndex].value,o=document.getElementById("lableSeveRoomRate"),d=new FormData;d.append("BuildingID",a),d.append("monthly",t),d.append("yearly",n),d.append("st",e);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var t=this.responseText.split(String.fromCharCode(5));s.innerHTML=t[1],1==t[0]?(1==e&&popupalert(1,"สำเร็จ","บันทึกข้อมูลค่าบำรุงห้องแล้ว"),o.innerHTML=t[2],s.innerHTML=t[1]):(popupalert(2,"ผิดพลาด","ระบบเกิดข้อผิดพลาด"),o.innerHTML=t[2])}},r.open("post","./members/tablemember.php",!0),r.send(d)}function EditUserOther(e,t){popupmodals("ตั้งค่าสถานะของ"+(1==t?"ผู้ใช้งาน":"ผู้พักอาศัย"),400,400,100);var n=new XMLHttpRequest;return n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(document.getElementById("modals-body").innerHTML=this.responseText)},n.open("POST","./members/SettingMembers.php"),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.send("UserID="+e+"&Status="+t),!1}function SaveSettingMember(e){var t=new XMLHttpRequest,n=document.getElementById("UserTypeID").value;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=this.responseText;1==e?(document.getElementById("myModals").style="display:none;",popupalert(1,"สำเร็จ","ปรับปรุงสถานะของผู้ใช้งานทั่วไป"),tableUser()):2==e&&popupalert(2,"ผิดพลาด","ระบบเกิดข้อผิดพลาด")}},t.open("POST","./members/SaveSettingMembers.php"),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("UserID="+e+"&UserType="+n)}function LeaderType(){var e=1==document.getElementById("SemiCommitee").checked?1:0,t=document.getElementById("LeaderTypes").value,n=document.getElementById("BuildingID").options[document.getElementById("BuildingID").selectedIndex].value,s=document.getElementById("UserID").value,a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=this.responseText;1==e?(document.getElementById("myModals").style="display:none;",popupalert(1,"สำเร็จ","ปรับปรุงสถานะของผู้พักอาศัย"),tableMember(n)):2==e&&popupalert(2,"ผิดพลาด","ระบบเกิดข้อผิดพลาด")}},a.open("POST","./members/SaveLeaderType.php"),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.send("UserID="+s+"&LT="+t+"&SemiCommitee="+e)}function exportfile(){var e=document.getElementById("monthly").options[document.getElementById("monthly").selectedIndex].value,t=document.getElementById("yearly").options[document.getElementById("yearly").selectedIndex].value;window.open("./members/report_excel_resident.php?monthly="+e+"&yearly="+t)}function addUserOther(e=0){var t=0==e?"เพิ่ม":"แก้ไข",n=new XMLHttpRequest,s=new FormData;s.append("UserID",e),popupmodals(t+"ข้อมูลผู้ใช้งานทั่วไป",500,558,100),n.onreadystatechange=function(){4==this.readyState&&200==this.status&&(document.getElementById("modals-body").innerHTML=this.responseText)},n.open("POST","./members/AddUserOther.php",!0),n.send(s)}function chvalSUO(){var e=document.getElementById("formAddUserOther");return""==chvailable("UserLogin").trim()?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.UserLogin.style="box-shadow: 0 0 3px #D11434;border: 1px solid #ee4d33ee;background: #f6d9d933;",e.UserLogin.focus(),!1):""==chvailable("Password").trim()?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.Password.style="box-shadow: 0 0 3px #D11434",e.Password.focus(),!1):""==chvailable("Email").trim()?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.Email.style="box-shadow: 0 0 3px #D11434",e.Email.focus(),!1):""==chvailable("UserPNameT").trim()?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.UserPNameT.style="box-shadow: 0 0 3px #D11434",e.UserPNameT.focus(),!1):""==chvailable("UserNameT").trim()?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.UserNameT.style="box-shadow: 0 0 3px #D11434",e.UserNameT.focus(),!1):0==chvailable("FacID")?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.FacID.style="box-shadow: 0 0 3px #D11434",e.FacID.focus(),!1):0==chvailable("PositionID")?(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.PositionID.style="box-shadow: 0 0 3px #D11434",e.PositionID.focus(),!1):0!=chvailable("UserType")||(popupalert(3,"เช็คข้อมูล","กรอกข้อมูลไม่ครบตามแบบฟอร์ม"),e.UserType.style="box-shadow: 0 0 3px #D11434",e.UserType.focus(),!1)}function SaveUserOther(){var e=new XMLHttpRequest,t=getdataform("formAddUserOther");return e.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=this.responseText;1==e?(alert(1),document.getElementById("myModals").style="display:none;",popupalert(1,"สำเร็จ","เพิ่มข้อมูลผู้ใช้งานทั่วไป"),tableUser()):2==e?popupalert(2,"ผิดพลาด","ระบบเกิดข้อผิดพลาด"):3==e&&popupalert(3,"ข้อมูลซ้ำ","มีข้อมูลนี้อยู่ในระบบแล้ว")}},e.open("POST","./members/SaveUserOthr.php",!0),e.send(t),!1}function ShowUserType(){document.getElementById("ShowUserType").style.display="block",document.getElementById("ShowResidnet").style.display="none",document.getElementById("tabResidnet").classList.remove("active"),document.getElementById("tabUserType").classList.add("active"),tableUser()}function ShowResidnet(){document.getElementById("ShowUserType").style.display="none",document.getElementById("ShowResidnet").style.display="block",document.getElementById("tabResidnet").classList.add("active"),document.getElementById("tabUserType").classList.remove("active"),tableMember(0)}